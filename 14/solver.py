# example.txt
# p=0,4 v=3,-3
# p=6,3 v=-1,-3
# p=10,3 v=-1,2
# p=2,0 v=2,-1
# p=0,0 v=1,3
# p=3,0 v=-2,-2
# p=7,6 v=-1,-3
# p=3,0 v=-1,-2
# p=9,3 v=2,3
# p=7,3 v=-1,2
# p=2,4 v=2,-3
# p=9,5 v=-3,-3

import ipdb
import re
inputFile = "input.txt"
# inputFile = "example.txt"

# example dimensions
# width = 11
# height = 7

# input dimensinos
width = 101
height = 103

pattern = r"p=(\d{1,3}),(\d{1,3}) v=(-?\d{1,3}),(-?\d{1,3})"
robots = []
with open(inputFile, "r") as file:
    for line in file:
        if line == "\n":
            continue
        result = re.search(pattern, line)
        robots.append({ \
            'px': int(result.group(1)), \
            'py': int(result.group(2)), \
            'dx': int(result.group(3)), \
            'dy': int(result.group(4)), \
        })

def printRobots(robots, width, height):
    map = [[0 for _ in range(width)] for _ in range(height)]
    for r in robots:
        try:
            map[r["py"]][r["px"]] += 1
        except:
            ipdb.set_trace()

    maybeTree = None
    interestingX, interestingY = 0, 0
    pauseForViewing = map
    for y in range(len(map)):
        for x in range(len(map[0])):
            if(map[y][x] == 0):
                print(".", end="")
            else:
                print(map[y][x], end="")
        print()
    print()
    if(pauseForViewing):
        input(f"tree at {interestingX}, {interestingY}?")

def solve1(robots, time, width, height):
    for _ in range(time):
        for r in robots:
            r["px"] = (r["px"] + r["dx"]) % width
            r["py"] = (r["py"] + r["dy"]) % height
        # printRobots(robots, width, height)

    # calculate "safety factor"
    quadrants = [0, 0, 0, 0]
    for r in robots:
        if r["px"] < (width - 1) // 2 and r["py"] < (height - 1) // 2:
            quadrants[0] += 1
        elif r["px"] > (width - 1) // 2 and r["py"] < (height - 1) // 2:
            quadrants[1] += 1
        elif r["px"] < (width - 1) // 2 and r["py"] > (height - 1) // 2:
            quadrants[2] += 1
        elif r["px"] > (width - 1) // 2 and r["py"] > (height - 1) // 2:
            quadrants[3] += 1

    print(f"quadrants:{quadrants}")
    total = 1
    for q in quadrants:
        total *= q
    return total

def solve2(robots, time, width, height):
    for t in range(1, time + 1):
        for r in robots:
            r["px"] = (r["px"] + r["dx"]) % width
            r["py"] = (r["py"] + r["dy"]) % height
        print(f"time: {t}")
        printRobots(robots, width, height)

    # calculate "safety factor"
    # quadrants = [0, 0, 0, 0]
    # for r in robots:
    #     if r["px"] < (width - 1) // 2 and r["py"] < (height - 1) // 2:
    #         quadrants[0] += 1
    #     elif r["px"] > (width - 1) // 2 and r["py"] < (height - 1) // 2:
    #         quadrants[1] += 1
    #     elif r["px"] < (width - 1) // 2 and r["py"] > (height - 1) // 2:
    #         quadrants[2] += 1
    #     elif r["px"] > (width - 1) // 2 and r["py"] > (height - 1) // 2:
    #         quadrants[3] += 1
    #
    # print(f"quadrants:{quadrants}")
    # total = 1
    # for q in quadrants:
    #     total *= q
    # return total

printRobots(robots, width, height)
print(solve1(robots, 100, width, height))
solve2(robots, 9999999, width, height)

"""
2
0|1

3
0|2
4
01|23
5
01|34
6
012|345
7
0 1 2 | 4 5 6

8
0 1 2 3|4 5 6 7 9

9
0 1 2 3 | 5 6 7 8

10
0 1 2 3 4x5 6 7 8 9

11
0 1 2 3 4 x 6 7 8 9 10

"""

"""
time: 7484
......................................1........1........1............................................
...........................................1...............1.........................................
.....................................................................................................
.1..................................1................................................................
.....................1...........................................1.....................1.............
..........1..........................................................................................
..................1.......................................1..............1...........................
..............................1...............1....................1.................................
.......1..............1............................1.................................................
.........11..............................................1.........................1.................
..........1...................................................1......................................
.....................................................................................................
.....................................................................................................
.1...................................................................................................
.............................................1.......................................................
.....................................................................................................
...............1..............1.......................................................1..............
............................................1........................................................
.....................................................................................................
.....................................................................................................
....................................................................1................................
......................................................................1..............................
..................................1..................................................................
............................................1........................................................
........................................................1...1........................................
................1....................................................................................
.....................................................................................................
.....................................................................................1...............
.................................1...............1..................................................1
.....................1..........................................................................1....
.1...................................................................................................
...........................................................................1.........................
.............................................1.......................................................
..........................................................1..........................................
1............................................................................1.......................
............1...................1......1111111111111111111111111111111......1........................
.......................................1.............................1....1..........................
........1.............1................1.............................1...............................
.......................................1.............................1...............................
.......................................1.............................1.........................1.....
.......................................1..............1..............1...............................
.......................................1.............111.............1...............................
......1................................1............11111............1........1.......1..............
......................1................1...........1111111...........1.....................1.1......1
.......................................1..........111111111..........1...............................
...............1....1..................1............11111............1...............................
................................1......1...........1111111...........1........1......................
.1.....................................1..........111111111..........1...............................
.......................................1.........11111111111.........1..............................1
...........................1.....1.....1........1111111111111........1........1......................
........................1..............1..........111111111..........1...............................
.......................................1.........11111111111.........1...............................
.........1.............................1........1111111111111........1...............................
............1...1......................1.......111111111111111.......1...............................
.....................................1.1......11111111111111111......1...............................
.......11..............................1........1111111111111........1...............................
.......................................1.......111111111111111.......1...............................
.......................................1......11111111111111111......1...............................
.......................................1.....1111111111111111111.....1...............................
.......................................1....111111111111111111111....1...............................
.......................................1.............111.............1......1........................
.......................................1.............111.............1...............................
......................1................1.............111.............1................1..............
.......................................1.............................1...............................
.......................................1.............................1...............................
.......................................1.............................1...........................1...
.......................................1.............................1...............................
....................1..................1111111111111111111111111111111...............................
..............................................................................1......................
.....................................................................................................
..........................1...1..........................................................1...........
...............................1..........................1..........................................
.......................1....................1........................................................
......1..............................................................................................
........1........................................................................................1...
............................................................................................1........
.....................................................................................................
.........................1..............................................1............................
......................................................1..............................................
................................1.........1...1....1.................................................
..................................................................................................1..
.........................1..........................................1........1.........1.............
.....................................................................................................
.....................................................................................................
........................................................................1............................
......................1..............................................................................
.........1............1..............................1...............................................
..................................1...........................1......................................
.................................1.........................................1.........................
...........................................................1.........................................
....................................................1................................................
...................1..........................................................1......................
...........................................................................1.........................
............1..............................1................................1........................
.....................................................................1...............................
.....................................................................................................
.................................1......................................1.....1...........1..........
1..................1..1.....1..........................1.............................................
.....................................1...............................................................
...................................................1...............................................1.
....................1......1.........................................................................
.................1..................................................................................1
..........................1................................................1..1......................

tree at 62, 67?
""""
